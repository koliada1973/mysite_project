{% extends "credit_system/base.html" %}

{% block page_title %}Платежі по кредиту №{{ credit.number }}{% endblock %}

{% block content %}
    <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
            <strong>Платежі по кредиту №{{ credit.number }}</strong>
        </div>

        <div class="card-body">

            <div class="mb-4">
                <p><strong>Позичальник:</strong> {{ credit.user.get_full_name }}</p>
                <p><strong>Начальна дата:</strong> {{ credit.start_date|date:"d.m.Y" }}</p>
                <p><strong>Начальна сума:</strong> {{ credit.summa_credit }} грн</p>
                <p><strong>% ставка:</strong> {{ credit.percent }} %</p>
            </div>

{#            <h5 class="mb-3">Історія платежів</h5>#}

            <table class="table table-bordered table-hover">
            <thead class="table-primary">
                <tr>
                    <th>Дата</th>
                    <th>Платіж</th>
                    <th>Нараховані %</th>
                    <th>Погашені %</th>
                    <th>Погашено кредиту</th>
                    <th>Борг по %</th>
                    <th>Залишок кредиту</th>
                </tr>
            </thead>
                <tbody>
                    {% for payment in payments %}
                        <tr>
                            <td>{{ payment.date_pay|date:"d.m.Y" }}</td>
                            <td>{{ payment.pay|floatformat:2 }} грн</td>
                            <td>{{ payment.summa_percent|floatformat:2 }} грн</td>
                            <td>{{ payment.pog_summa_percent|floatformat:2 }} грн</td>
                            <td>{{ payment.pog_credit|floatformat:2 }} грн</td>
                            <td>{{ payment.dolg_percent|floatformat:2 }} грн</td>
                            <td>{{ payment.ostatok|floatformat:2 }} грн</td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="7">Платежі по цьому кредиту ще не надходили.</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>

            {# Інформація про закриття кредиту #}
            {% if credit.closed %}
                <p class="mt-3"><span class="badge bg-success">Кредит Закритий</span></p>
            {% endif %}


            {% if user.is_superuser or user.is_manager %}
                <a href="{% url 'credit_detail' credit.pk %}" class="btn btn-outline-primary mt-3">← Повернутись до кредиту</a>
                <a href="{% url 'add_payment' credit.pk %}" class="btn btn-primary mt-3">Додати платіж</a>
            {% elif user.is_client %}
                <a href="{% url 'credit_detail' credit.pk %}" class="btn btn-outline-primary mt-3">← Повернутись до кредиту</a>
            {% endif %}
        </div>
    </div>
{% endblock %}